---
title: 鸢尾花分类
date: 2019-10-08 14:17:54
tags: machine learning
categories: machine learning
description: 本文利用已知的鸢尾花的测量数据，所以为一个监督学习问题，预测花属于三种品种中的某一种，为三分类问题
cover: /Depository/Img/Post/0023.jpeg
top_img: /Depository/Img/Post/0013.jpg
---

**<center>机器学习之：鸢尾花分类</center>**

本文利用已知的鸢尾花的测量数据，所以为一个监督学习问题，预测花属于三种品种中的某一种，为三分类问题

本文用到的鸢尾花(Iris)数据集为机器学习中的经典数据集，该数据集包含在scikit-learn的datasets模块中


### 加载数据
首先导入默认库

```bash
import numpy as np
import pandas as pd
import matplotlib.pyplot as plot
```

因为鸢尾花数据包含在scikit-learn的datasets模块中,通过调用load_iris函数来加载数据

```python
from sklearn.datasets import load_iris
iris_dataset = load_iris()
```

load-rirs返回的iris对象是一个Bunch对象，类似于字典，里面包含键和值

```python
print("Keys of iris_dataset: \n{}".format(iris_dataset.keys()))
```

输出：

```python
Keys of iris_dataset:
dict_keys(['data', 'target', 'target_names', 'DESCR', 'feature_names', 'filename'])
```

* `'DESCR'`键的值是数据集的简要说明
* `'terget_names'`键对应的值是一个字符串数组，包含我们要预测的花的品种
* `'feature_names'`键对应的值是一个字符串列表，对每一个特征进行说明
* `'data'`里面是花萼的长度宽度和花瓣的长度宽度(cm),是一个NumPy数组
* `'terget'`包含的是测量过的每朵花的品种，是一个NumPy数组

*由`iris['target_names']`中得知,`'target'`中的0代表setosa，1代表versicolor，2代表virginica*

### 拆分数据
scikit-learn中的train_test_splie函数可以对数据进行打乱拆分

```python
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(
    iris_dataset['data'], iris_dataset['target'], random_state = 0)
```

* 这个函数将75%的数据及标志作为训练集，25%的数据及标志作为测试集
* scikit-learn中常用X表示数据，y表示标签(f(x)=y)，数据为二维数组所以用大写X，标签为一维数组用小写y
* 在拆分数据集前，train_test_split会将数据集伪随机打乱再进行拆分，用random_state参数指定随机数生成器的种子保证打乱后的次序一致，方便得到一致的结果
* train_test_split函数的输出为X_train,X_test,y_train,y_test,均为NumPy数组

### 观察数据
此处可绘制散点图对数据进行观察，选用pandas中的scatter_matrix函数绘制，具体方法不再赘述
* 用pandas绘制图像首先要先将数据转换成pandas DataFrame

### 构建模型
此处我们选用k邻近算法：构建此模型只需要保存训练集即可
* k邻近算法中的k表示的是邻居的个数
* k邻近算法是在neighbors模块中的KNeighborsClassifier类中实现
* k邻近算法最重要的参数为n_neighbors表示邻居的数目，我们这里设置为1

首先对KNeighborsClassifier类实例化为一个对象，设置n_neighbors参数为1

```python
from sklearn.neighbors import KNeighborsClassifier
knn = KNeighborsClassifier(n_neighbors=1)
```

基于训练集来构建模型，调用knn对象的fit方法，输入参数为X_train和y_train，二者皆为NumPy数据，前者包含训练数据，后者包含相应的训练标签

```python
knn.fit(X_train, y_train)
```

输出：

```python
KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
                     metric_params=None, n_jobs=None, n_neighbors=1, p=2,
                     weights='uniform')
```
* 其中n_neighbors参数为手动输入的1,其他参数均为默认

此时模型已经构建完毕

### 作出预测

假设现在有一朵鸢尾花，花萼长5cm，宽2.9cm，花瓣长1cm，宽0.2cm，预测该花为哪种鸢尾花

1. 首先将该花数据放入一个NumPy数组中，

```python
X_new = np.array([[5, 2.9, 1, 0.2]])
```
*此处将花的数据转换为一个二维NumPy数组的一行，因为scikit-learn的输入数据必须为二位数组*

2. 调用knn对象的predict方法来进行预测

```python
prediction = knn.predict(X_new)
```

3. 展示预测结果

```python
print("Predicted target name: {}".format(
    iris_dataset['target_names'][prediction]))
```

输出：Predicted target name: ['setosa']

### 评估模型
**通过模型在测试集上的计算精度来评估模型的优劣**
* 方法一

```python
y_pred = knn.predict(X_test)
print("Test set score: {:.2f}".format(np.mean(y_pred == y_test)))
```

*输出：Test set score: 0.97*

* 方法二 

*直接调用knn的score方法进行评估*

```python
print("Test set score: {:.2f}".format(knn.score(X_test, y_test)))
```

*输出：Test set score: 0.97*

### 核心代码
此模型应用核心代码如下:

```python
X_train, X_test, y_train, y_test = train_test_split(
    iris_dataset['data'], iris_dataset['target'], random_state = 0)
knn = KNeighborsClassifier(n_neighbors = 1)
knn.fit(X_train, y_train)
knn.score(X_test, y_test)
```

### 附：
**scikit-learn**
* 详细文档:http://scikit-learn.org/stable/documentation
* 用户指南:http://scikit-learn.org/stable/user_guide.html

**机器学习常用python库**
* Jupyter Notebook 
* NumPy
* pandas
* matplotlib
* SciPy

**一般模型默认导入库**

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
```
**默认加入下列命令，否则需要调用`plt.show`来展示图像**
```python
%matplotlib notebook
```



